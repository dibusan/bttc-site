
<table class=" table table-striped table-bordered">
  <thead>
  <tr>
    <% current_date = @start_date %>
    <th> Time </th>
    <% 7.times do %>
      <th>
        <%= current_date.strftime('%A') %>
        <% current_date = current_date + 1.day %>
      </th>
    <% end %>
  </tr>
  </thead>

  <tbody>
  <% current_date_time = @start_date.beginning_of_day + 8.hours %>
  <% while current_date_time < @start_date.beginning_of_day + 20.hours %>
    <tr>
      <td>
        <%= current_date_time.strftime('%l:%M %P') %>
      </td>
      <% 7.times do %>
        <%
          if @week_schedule[current_date_time.to_i].nil?
            count = max_availability
          else
            count = @week_schedule[current_date_time.to_i][:count]
          end
        %>

        <td
          class="time-block <%= class_for(
                                    count,
                                    type_lesson,
                                    (@week_schedule[current_date_time.to_i] and
                                        @week_schedule[current_date_time.to_i][:current_user])
                                ) || "many" %>"

            data-date_time="<%= current_date_time %>">

          <%= count %>
        </td>

        <% current_date_time += 1.day %>
      <% end %>
      <% current_date_time = (current_date_time - 7.day) + 2.hours %>
    </tr>
  <% end %>
  </tbody>
</table>